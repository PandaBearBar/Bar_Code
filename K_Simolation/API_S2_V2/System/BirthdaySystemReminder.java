package K_Simolation.API_S2_V2.System;

import K_Simolation.API_S2_V2.Beans.Person;
import K_Simolation.API_S2_V2.Task.BirthdayTask;
import K_Simolation.API_S2_V2.Utils.BirthdayStatistics;
import K_Simolation.API_S2_V2.Utils.FactoryUtil;

import java.time.LocalDate;
import java.util.*;

public class BirthdaySystemReminder {
    private Set<Person> people;
    private BirthdayTask task;
    private static Scanner scanner;
    private static List<Person> personList;
    private static boolean isWorking = true;

    public BirthdaySystemReminder() {
        scanner = new Scanner(System.in);
        this.people = new HashSet<>();
        task = new BirthdayTask(people);
        Thread thread = new Thread(task);
        thread.start();
    }

    public static boolean isIsWorking() {
        return isWorking;
    }

    public static void setIsWorking(boolean isWorking) {
        BirthdaySystemReminder.isWorking = isWorking;
    }

    public Set<Person> getPeople() {
        return people;
    }

    public void setPeople(Set<Person> people) {
        this.people = people;
    }

    public BirthdayTask getTask() {
        return task;
    }

    public void setTask(BirthdayTask task) {
        this.task = task;
    }

    public static Scanner getScanner() {
        return scanner;
    }

    public static void setScanner(Scanner scanner) {
        BirthdaySystemReminder.scanner = scanner;
    }

    public static List<Person> getPersonList() {
        return personList;
    }

    public static void setPersonList(List<Person> personList) {
        BirthdaySystemReminder.personList = personList;
    }

    public void showMenu() {
        System.out.println("" +
                "██╗  ██╗███████╗██╗     ██╗      ██████╗ \n" +
                "██║  ██║██╔════╝██║     ██║     ██╔═══██╗\n" +
                "███████║█████╗  ██║     ██║     ██║   ██║\n" +
                "██╔══██║██╔══╝  ██║     ██║     ██║   ██║\n" +
                "██║  ██║███████╗███████╗███████╗╚██████╔╝\n" +
                "╚═╝  ╚═╝╚══════╝╚══════╝╚══════╝ ╚═════╝ \n" +
                "                                         \n" +
                " ██╗          █████╗ ██████╗ ██████╗ \n" +
                "███║         ██╔══██╗██╔══██╗██╔══██╗\n" +
                "╚██║         ███████║██║  ██║██║  ██║\n" +
                " ██║         ██╔══██║██║  ██║██║  ██║\n" +
                " ██║██╗      ██║  ██║██████╔╝██████╔╝\n" +
                " ╚═╝╚═╝      ╚═╝  ╚═╝╚═════╝ ╚═════╝ \n" +
                "                                   \n" +
                "██████╗      ██████╗ ███████╗███╗   ███╗ ██████╗ ██╗   ██╗███████╗\n" +
                "╚════██╗     ██╔══██╗██╔════╝████╗ ████║██╔═══██╗██║   ██║██╔════╝\n" +
                " █████╔╝     ██████╔╝█████╗  ██╔████╔██║██║   ██║██║   ██║█████╗  \n" +
                "██╔═══╝      ██╔══██╗██╔══╝  ██║╚██╔╝██║██║   ██║╚██╗ ██╔╝██╔══╝  \n" +
                "███████╗██╗  ██║  ██║███████╗██║ ╚═╝ ██║╚██████╔╝ ╚████╔╝ ███████╗\n" +
                "╚══════╝╚═╝  ╚═╝  ╚═╝╚══════╝╚═╝     ╚═╝ ╚═════╝   ╚═══╝  ╚══════╝\n" +
                "                                                                    \n" +
                "██████╗      ██╗     ██╗███████╗████████╗     ██████╗ ███████╗    ███████╗██████╗ ██╗███████╗███╗   ██╗██████╗ ███████╗\n" +
                "╚════██╗     ██║     ██║██╔════╝╚══██╔══╝    ██╔═══██╗██╔════╝    ██╔════╝██╔══██╗██║██╔════╝████╗  ██║██╔══██╗██╔════╝\n" +
                " █████╔╝     ██║     ██║███████╗   ██║       ██║   ██║█████╗      █████╗  ██████╔╝██║█████╗  ██╔██╗ ██║██║  ██║███████╗\n" +
                " ╚═══██╗     ██║     ██║╚════██║   ██║       ██║   ██║██╔══╝      ██╔══╝  ██╔══██╗██║██╔══╝  ██║╚██╗██║██║  ██║╚════██║\n" +
                "██████╔╝██╗  ███████╗██║███████║   ██║       ╚██████╔╝██║         ██║     ██║  ██║██║███████╗██║ ╚████║██████╔╝███████║\n" +
                "╚═════╝ ╚═╝  ╚══════╝╚═╝╚══════╝   ╚═╝        ╚═════╝ ╚═╝         ╚═╝     ╚═╝  ╚═╝╚═╝╚══════╝╚═╝  ╚═══╝╚═════╝ ╚══════╝\n" +
                "                                                                                                                         \n" +
                "██╗  ██╗     ███╗   ██╗██╗   ██╗███╗   ███╗     ██████╗ ███████╗    ███████╗██████╗ ██╗███████╗███╗   ██╗██████╗ ███████╗\n" +
                "██║  ██║     ████╗  ██║██║   ██║████╗ ████║    ██╔═══██╗██╔════╝    ██╔════╝██╔══██╗██║██╔════╝████╗  ██║██╔══██╗██╔════╝\n" +
                "███████║     ██╔██╗ ██║██║   ██║██╔████╔██║    ██║   ██║█████╗      █████╗  ██████╔╝██║█████╗  ██╔██╗ ██║██║  ██║███████╗\n" +
                "╚════██║     ██║╚██╗██║██║   ██║██║╚██╔╝██║    ██║   ██║██╔══╝      ██╔══╝  ██╔══██╗██║██╔══╝  ██║╚██╗██║██║  ██║╚════██║\n" +
                "     ██║██╗  ██║ ╚████║╚██████╔╝██║ ╚═╝ ██║    ╚██████╔╝██║         ██║     ██║  ██║██║███████╗██║ ╚████║██████╔╝███████║\n" +
                "     ╚═╝╚═╝  ╚═╝  ╚═══╝ ╚═════╝ ╚═╝     ╚═╝     ╚═════╝ ╚═╝         ╚═╝     ╚═╝  ╚═╝╚═╝╚══════╝╚═╝  ╚═══╝╚═════╝ ╚══════╝\n" +
                "                                                                                                                           \n" +
                "███████╗     ██╗  ██╗ █████╗ ██████╗ ██████╗ ██╗   ██╗    ███╗   ███╗ ██████╗ ███╗   ██╗████████╗██╗  ██╗\n" +
                "██╔════╝     ██║  ██║██╔══██╗██╔══██╗██╔══██╗╚██╗ ██╔╝    ████╗ ████║██╔═══██╗████╗  ██║╚══██╔══╝██║  ██║\n" +
                "███████╗     ███████║███████║██████╔╝██████╔╝ ╚████╔╝     ██╔████╔██║██║   ██║██╔██╗ ██║   ██║   ███████║\n" +
                "╚════██║     ██╔══██║██╔══██║██╔═══╝ ██╔═══╝   ╚██╔╝      ██║╚██╔╝██║██║   ██║██║╚██╗██║   ██║   ██╔══██║\n" +
                "███████║██╗  ██║  ██║██║  ██║██║     ██║        ██║       ██║ ╚═╝ ██║╚██████╔╝██║ ╚████║   ██║   ██║  ██║\n" +
                "╚══════╝╚═╝  ╚═╝  ╚═╝╚═╝  ╚═╝╚═╝     ╚═╝        ╚═╝       ╚═╝     ╚═╝ ╚═════╝ ╚═╝  ╚═══╝   ╚═╝   ╚═╝  ╚═╝\n" +
                "                                                                                                           \n" +
                " ██████╗     ███████╗ █████╗ ██████╗ ██╗  ██╗   ██╗    ███╗   ███╗ ██████╗ ███╗   ██╗████████╗██╗  ██╗\n" +
                "██╔════╝     ██╔════╝██╔══██╗██╔══██╗██║  ╚██╗ ██╔╝    ████╗ ████║██╔═══██╗████╗  ██║╚══██╔══╝██║  ██║\n" +
                "███████╗     ███████╗███████║██║  ██║██║   ╚████╔╝     ██╔████╔██║██║   ██║██╔██╗ ██║   ██║   ███████║\n" +
                "██╔═══██╗    ╚════██║██╔══██║██║  ██║██║    ╚██╔╝      ██║╚██╔╝██║██║   ██║██║╚██╗██║   ██║   ██╔══██║\n" +
                "╚██████╔╝██╗ ███████║██║  ██║██████╔╝███████╗██║       ██║ ╚═╝ ██║╚██████╔╝██║ ╚████║   ██║   ██║  ██║\n" +
                " ╚═════╝ ╚═╝ ╚══════╝╚═╝  ╚═╝╚═════╝ ╚══════╝╚═╝       ╚═╝     ╚═╝ ╚═════╝ ╚═╝  ╚═══╝   ╚═╝   ╚═╝  ╚═╝\n" +
                "                                                                                                         \n" +
                "███████╗       █████╗ ██╗     ██╗         ███████╗██╗   ██╗███████╗███╗   ██╗████████╗███████╗\n" +
                "╚════██║      ██╔══██╗██║     ██║         ██╔════╝██║   ██║██╔════╝████╗  ██║╚══██╔══╝██╔════╝\n" +
                "    ██╔╝      ███████║██║     ██║         █████╗  ██║   ██║█████╗  ██╔██╗ ██║   ██║   ███████╗\n" +
                "   ██╔╝       ██╔══██║██║     ██║         ██╔══╝  ╚██╗ ██╔╝██╔══╝  ██║╚██╗██║   ██║   ╚════██║\n" +
                "   ██║██╗     ██║  ██║███████╗███████╗    ███████╗ ╚████╔╝ ███████╗██║ ╚████║   ██║   ███████║\n" +
                "   ╚═╝╚═╝     ╚═╝  ╚═╝╚══════╝╚══════╝    ╚══════╝  ╚═══╝  ╚══════╝╚═╝  ╚═══╝   ╚═╝   ╚══════╝\n" +
                "                                                                                             \n" +
                " █████╗       ███████╗██╗  ██╗██╗████████╗    ██████╗ ██████╗  ██████╗  ██████╗ ██████╗  █████╗ ███╗   ███╗\n" +
                "██╔══██╗      ██╔════╝╚██╗██╔╝██║╚══██╔══╝    ██╔══██╗██╔══██╗██╔═══██╗██╔════╝ ██╔══██╗██╔══██╗████╗ ████║\n" +
                "╚█████╔╝      █████╗   ╚███╔╝ ██║   ██║       ██████╔╝██████╔╝██║   ██║██║  ███╗██████╔╝███████║██╔████╔██║\n" +
                "██╔══██╗      ██╔══╝   ██╔██╗ ██║   ██║       ██╔═══╝ ██╔══██╗██║   ██║██║   ██║██╔══██╗██╔══██║██║╚██╔╝██║\n" +
                "╚█████╔╝██╗   ███████╗██╔╝ ██╗██║   ██║       ██║     ██║  ██║╚██████╔╝╚██████╔╝██║  ██║██║  ██║██║ ╚═╝ ██║\n" +
                " ╚════╝ ╚═╝   ╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝       ╚═╝     ╚═╝  ╚═╝ ╚═════╝  ╚═════╝ ╚═╝  ╚═╝╚═╝  ╚═╝╚═╝     ╚═╝\n" +
                "                                                                                                        " +
                "");
    }

    public void startSystem() {
        while (isWorking) {
            personList = new ArrayList<>(people);
            showMenu();
            switch (initNumber(scanner.next())) {
                case 1:
                    addPerson(FactoryUtil.initPerson());
                    break;
                case 2:
                    System.out.println("what is the ID of ur friend that u want to delete ?");
                    deletePerson(initNumber(scanner.next()));
                    break;
                case 3:
                    printAll();
                    break;
                case 4:
                    printCount();
                    break;
                case 5:
                    PrintHappyMonth();
                    break;
                case 6:
                    printSadlyMonth();
                    break;
                case 7:
                    printEvents();
                    break;
                case 8:
                    endSystem();
                    break;
                case 9:
                    programSecrets();
                    break;
                default:
                    failRespond();
                    break;
            }
        }


    }

    private void failRespond() {
        System.out.println("" +
                "██╗███╗   ██╗██╗   ██╗ █████╗ ██╗     ██╗██████╗              ████████╗██████╗ ██╗   ██╗     █████╗  ██████╗  █████╗ ██╗███╗   ██╗       ██╗ \n" +
                "██║████╗  ██║██║   ██║██╔══██╗██║     ██║██╔══██╗             ╚══██╔══╝██╔══██╗╚██╗ ██╔╝    ██╔══██╗██╔════╝ ██╔══██╗██║████╗  ██║    ██╗╚██╗\n" +
                "██║██╔██╗ ██║██║   ██║███████║██║     ██║██║  ██║                ██║   ██████╔╝ ╚████╔╝     ███████║██║  ███╗███████║██║██╔██╗ ██║    ╚═╝ ██║\n" +
                "██║██║╚██╗██║╚██╗ ██╔╝██╔══██║██║     ██║██║  ██║                ██║   ██╔══██╗  ╚██╔╝      ██╔══██║██║   ██║██╔══██║██║██║╚██╗██║    ▄█╗ ██║\n" +
                "██║██║ ╚████║ ╚████╔╝ ██║  ██║███████╗██║██████╔╝██╗██╗██╗       ██║   ██║  ██║   ██║       ██║  ██║╚██████╔╝██║  ██║██║██║ ╚████║    ▀═╝██╔╝\n" +
                "╚═╝╚═╝  ╚═══╝  ╚═══╝  ╚═╝  ╚═╝╚══════╝╚═╝╚═════╝ ╚═╝╚═╝╚═╝       ╚═╝   ╚═╝  ╚═╝   ╚═╝       ╚═╝  ╚═╝ ╚═════╝ ╚═╝  ╚═╝╚═╝╚═╝  ╚═══╝       ╚═╝ \n" +
                "                                                                                                                                             ");
    }

    private void programSecrets() {
        people.add(new Person(LocalDate.now()));
    }

    private void printSadlyMonth() {
        System.out.println("Sadly Month : " + BirthdayStatistics.getSadlyMonth());
    }

    public void PrintHappyMonth() {
        System.out.println("Happiest Month : " + BirthdayStatistics.getHappyMonth());
    }

    public void printCount() {
        System.out.println("Num of friends : " + people.size());
    }

    public void printEvents() {
        for (int i = 1; i <= 12 ; i++) {
            int babies = BirthdayStatistics.getEvents().get(i);
            System.out.println("Month : " + String.format("%02d", i) + " - " + String.format("%02d", babies) + " : Birthdays");
        }
    }

    public void printAll() {
        Collections.sort(personList);
        for (Person p : personList) {
            System.out.println(p);
        }
    }

    public void deletePerson(int personId) {
        boolean isThere = false;
        for (Person p : people) {
            if (personId == p.getId()){
                people.remove(p);
                isThere = true;
                System.out.println("" +
                        "██████╗ ███████╗██╗     ███████╗████████╗███████╗██████╗ \n" +
                        "██╔══██╗██╔════╝██║     ██╔════╝╚══██╔══╝██╔════╝██╔══██╗\n" +
                        "██║  ██║█████╗  ██║     █████╗     ██║   █████╗  ██║  ██║\n" +
                        "██║  ██║██╔══╝  ██║     ██╔══╝     ██║   ██╔══╝  ██║  ██║\n" +
                        "██████╔╝███████╗███████╗███████╗   ██║   ███████╗██████╔╝\n" +
                        "╚═════╝ ╚══════╝╚══════╝╚══════╝   ╚═╝   ╚══════╝╚═════╝ \n" +
                        "                                                         ");
                break;
            }
        }
       if (!isThere){
           System.out.println("" +
                   "███╗   ██╗ ██████╗ ███╗   ██╗███████╗██╗  ██╗██╗███████╗████████╗███████╗███╗   ██╗ ██████╗███████╗\n" +
                   "████╗  ██║██╔═══██╗████╗  ██║██╔════╝╚██╗██╔╝██║██╔════╝╚══██╔══╝██╔════╝████╗  ██║██╔════╝██╔════╝\n" +
                   "██╔██╗ ██║██║   ██║██╔██╗ ██║█████╗   ╚███╔╝ ██║███████╗   ██║   █████╗  ██╔██╗ ██║██║     █████╗  \n" +
                   "██║╚██╗██║██║   ██║██║╚██╗██║██╔══╝   ██╔██╗ ██║╚════██║   ██║   ██╔══╝  ██║╚██╗██║██║     ██╔══╝  \n" +
                   "██║ ╚████║╚██████╔╝██║ ╚████║███████╗██╔╝ ██╗██║███████║   ██║   ███████╗██║ ╚████║╚██████╗███████╗\n" +
                   "╚═╝  ╚═══╝ ╚═════╝ ╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝╚══════╝   ╚═╝   ╚══════╝╚═╝  ╚═══╝ ╚═════╝╚══════╝\n" +
                   "                                                                                                   ");
       }
    }

    public void addPerson(Person person) {
        people.add(person);
        System.out.println("" +
                " █████╗ ██████╗ ██████╗ ███████╗██████╗ \n" +
                "██╔══██╗██╔══██╗██╔══██╗██╔════╝██╔══██╗\n" +
                "███████║██║  ██║██║  ██║█████╗  ██║  ██║\n" +
                "██╔══██║██║  ██║██║  ██║██╔══╝  ██║  ██║\n" +
                "██║  ██║██████╔╝██████╔╝███████╗██████╔╝\n" +
                "╚═╝  ╚═╝╚═════╝ ╚═════╝ ╚══════╝╚═════╝ \n" +
                "                                        ");
    }

    public void endSystem() {
        scanner.close();
        isWorking = false;
        System.out.println("" +
                " ██████╗ ██╗  ██╗             ██████╗ ██╗   ██╗███████╗\n" +
                "██╔═══██╗██║ ██╔╝             ██╔══██╗╚██╗ ██╔╝██╔════╝\n" +
                "██║   ██║█████╔╝              ██████╔╝ ╚████╔╝ █████╗  \n" +
                "██║   ██║██╔═██╗              ██╔══██╗  ╚██╔╝  ██╔══╝  \n" +
                "╚██████╔╝██║  ██╗██╗██╗██╗    ██████╔╝   ██║   ███████╗\n" +
                " ╚═════╝ ╚═╝  ╚═╝╚═╝╚═╝╚═╝    ╚═════╝    ╚═╝   ╚══════╝\n" +
                "                                                       ");
    }

    private int initNumber(String In) {
        boolean isDigit= true;
        for (int i = 0; i < In.length(); i++) {
            if (!In.matches("[0-9]+")){
                isDigit = false;
                break;
            }
        }
        return (isDigit) ? Integer.parseInt(In) : 0;
    }

    @Override
    public String toString() {
        return "BirthdaySystemReminder{" +
                "people=" + people +
                '}';
    }
}
